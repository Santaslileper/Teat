<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ page.title }}</title>
<style>
  body { margin:0; font-family:sans-serif; background:#111; color:#eee; padding-top:60px; }
  nav {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    background: #222;
    display: flex;
    justify-content: center;
    overflow-x: auto;
    white-space: nowrap;
    z-index: 1000;
  }
  nav a { display:inline-block; padding:14px 20px; color:#0f0; text-decoration:none; }
  nav a:hover { background:#333; }
  .page { max-width:800px; margin:auto; padding:20px; min-height:100vh; }
</style>
</head>
<body>

<nav id="navbar">
  {% for page in site.pages %}
    {% if page.title %}
      <a href="{{ page.url }}">{{ page.title }}</a>
    {% endif %}
  {% endfor %}
</nav>

<div class="page" id="page-content">
  {{ content }}
</div>

<script>
const links = document.querySelectorAll('#navbar a');
const contentDiv = document.getElementById('page-content');

links.forEach(link => {
  link.addEventListener('click', e => {
    e.preventDefault();
    const url = link.getAttribute('href');

    fetch(url)
      .then(res => res.text())
      .then(html => {
        // Parse the fetched HTML
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');

        // Grab only the content div
        const newContent = doc.getElementById('page-content').innerHTML;
        contentDiv.innerHTML = newContent;

        // Update browser URL without reloading
        window.history.pushState({}, '', url);

        // Scroll to top
        window.scrollTo(0,0);
      });
  });
});

// Handle back/forward buttons
window.addEventListener('popstate', () => {
  const url = location.pathname;
  fetch(url)
    .then(res => res.text())
    .then(html => {
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, 'text/html');
      contentDiv.innerHTML = doc.getElementById('page-content').innerHTML;
    });
});
</script>

</body>
</html>