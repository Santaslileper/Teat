<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"><title>All-in-One Web IDE Pro</title><script src="https://cdn.tailwindcss.com"></script><style>:root{--bg-primary:#1e1e1e;--bg-secondary:#252526;--bg-editor:#1e1e1e;--color-text:#cccccc;--color-accent:#007acc;--color-line-number:#6a6a6a;--font-size-default:14px;--font-size-zoomed:18px}body{font-family:ui-sans-serif,system-ui;background-color:var(--bg-primary);color:var(--color-text);margin:0;display:flex;flex-direction:column;height:100vh;overflow:hidden;touch-action:pan-y}.editor-container{position:relative;height:100%;overflow:hidden;display:flex}.editor-wrapper{position:relative;flex-grow:1;height:100%;overflow:hidden}#line-numbers{background-color:var(--bg-editor);color:var(--color-line-number);padding:10px 5px 10px 10px;font-family:monospace;font-size:var(--font-size-default);text-align:right;border-right:1px solid #333;overflow:hidden;user-select:none;line-height:1.5;flex-shrink:0}#highlighted-code,#code-editor{margin:0;padding:10px;border:none;outline:none;overflow:auto;white-space:pre;word-wrap:normal;font-family:monospace;font-size:var(--font-size-default);line-height:1.5;tab-size:4;box-sizing:border-box;transition:font-size .15s ease-in-out}.zoom-in{font-size:var(--font-size-zoomed)!important}#highlighted-code{background:var(--bg-editor);color:var(--color-text);position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}#code-editor{background:transparent;color:transparent;caret-color:var(--color-text);z-index:10;resize:none;position:absolute;top:0;left:0;width:100%;height:100%}.h-tag{color:#569cd6}.h-attr{color:#9cd656}.h-string{color:#d69d66}.h-comment{color:#6a9955}.h-keyword{color:#c586c0}.button-style{padding:6px 12px;border-radius:4px;font-weight:500;transition:background-color .2s}@keyframes spin{to{transform:rotate(360deg)}}.animate-spin{animation:spin 1s linear infinite}@media (max-width:767px){.split-panel{width:100%!important;height:100%}.inactive-panel{display:none!important}main{flex-direction:column}}</style></head><body onload="initIDE()"><input type="file" id="file-input" accept=".html,.txt" style="display:none"><div id="loading-overlay" class="fixed inset-0 bg-gray-900 bg-opacity-90 flex items-center justify-center z-50 hidden"><div class="flex flex-col items-center w-64"><svg class="animate-spin h-8 w-8 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><p id="loading-message" class="mt-4 text-white text-sm">Processing...</p><div class="w-full bg-gray-700 rounded-full h-2.5 mt-2"><div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-100 ease-linear" style="width:0%"></div></div><p id="progress-percent" class="mt-1 text-white text-xs">0%</p></div></div><header class="flex items-center justify-between p-3 bg-gray-800 shadow-md flex-shrink-0"><div class="text-xl font-bold text-white"><span class="text-blue-400">Web</span>IDE</div><div class="hidden sm:flex space-x-2"><button onclick="createNewFile()" class="button-style bg-gray-700 hover:bg-gray-600 text-white">New</button><button onclick="openFile()" class="button-style bg-gray-700 hover:bg-gray-600 text-white">Open</button><button onclick="saveFile()" class="button-style bg-green-600 hover:bg-green-500 text-white">Save (HTML)</button><button onclick="copyCode()" class="button-style bg-gray-700 hover:bg-gray-600 text-white">Copy</button><button onclick="runCode()" class="button-style bg-blue-600 hover:bg-blue-500 text-white font-semibold">Run Code</button></div><div id="tab-controls" class="sm:hidden flex space-x-2"><button id="code-tab" onclick="switchTab('code')" class="button-style bg-blue-600 text-white active-tab">Code</button><button id="preview-tab" onclick="switchTab('preview')" class="button-style bg-gray-700 text-white">Preview</button></div></header><main class="flex flex-grow overflow-hidden"><section id="editor-panel" class="split-panel flex flex-col w-full sm:w-1/2 border-r border-gray-700 relative h-full"><div class="editor-container h-full"><pre id="line-numbers"></pre><div id="editor-wrapper" class="editor-wrapper" onclick="toggleZoom()"><pre id="highlighted-code"></pre><textarea id="code-editor" spellcheck="false" oninput="handleInput()" onscroll="syncScroll()" onselect="updateCursorPosition()" onclick="updateCursorPosition()" onfocus="updateCursorPosition()"></textarea></div></div></section><section id="preview-panel" class="split-panel flex flex-col w-full sm:w-1/2 bg-white h-full inactive-panel"><iframe id="preview-frame" class="w-full h-full border-0"></iframe></section></main><footer class="flex items-center justify-between p-2 bg-gray-900 text-xs text-gray-400 flex-shrink-0"><div id="save-status">Auto-Save: Initializing...</div><div id="cursor-position">Ln: 1, Col: 1</div></footer><div id="floating-bar" class="fixed bottom-4 right-4 z-40 space-y-2 sm:hidden"><button onclick="runCode()" title="Run Code" class="p-3 bg-blue-600 text-white rounded-full shadow-lg hover:bg-blue-500 transition duration-150"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M3 22v-20l18 10-18 10z"/></svg></button><button onclick="saveFile()" title="Save File" class="p-3 bg-green-600 text-white rounded-full shadow-lg hover:bg-green-500 transition duration-150"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M13 3h2.996v5h-2.996v-5zm11 1v20h-24v-24h20l4 4zm-14 5h-10v14h20v-10h-10v-4zm2 10h6v-2h-6v2z"/></svg></button></div><script>const codeEditor=document.getElementById('code-editor');const highlightedCode=document.getElementById('highlighted-code');const lineNumbers=document.getElementById('line-numbers');const previewFrame=document.getElementById('preview-frame');const saveStatus=document.getElementById('save-status');const cursorPosition=document.getElementById('cursor-position');const loadingOverlay=document.getElementById('loading-overlay');const progressBar=document.getElementById('progress-bar');const progressPercent=document.getElementById('progress-percent');const editorWrapper=document.getElementById('editor-wrapper');const LOCAL_STORAGE_KEY='webIDE_autosave';const LARGE_PASTE_THRESHOLD=5000;let autoSaveInterval;let isMobile=window.innerWidth<768;let isProcessingLargeFile=false;function toggleZoom(){if(document.activeElement===codeEditor)return;highlightedCode.classList.toggle('zoom-in');codeEditor.classList.toggle('zoom-in');lineNumbers.classList.toggle('zoom-in');syncScroll();updateLineNumbers()}function showLoading(message){progressPercent.textContent='0%';progressBar.style.width='0%';document.getElementById('loading-message').textContent=message||'Processing...';loadingOverlay.classList.remove('hidden')}function hideLoading(){loadingOverlay.classList.add('hidden')}function processCodeInChunks(code){if(isProcessingLargeFile)return;isProcessingLargeFile=true;showLoading('Analyzing and highlighting (0% to 90%)...');const lines=code.split('\n');const totalLines=lines.length;const CHUNK_COUNT=10;const totalHighlightingLines=totalLines;const chunkSize=Math.max(10,Math.ceil(totalHighlightingLines/CHUNK_COUNT));let currentLine=0;let highlightedHtml='';const processChunk=()=>{const startLine=currentLine;let endLine=Math.min(startLine+chunkSize,totalLines);let chunk=lines.slice(startLine,endLine).join('\n');chunk=chunk.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");chunk=chunk.replace(/(&lt;!--.*?--&gt;)/gs,'<span class="h-comment">$1</span>');chunk=chunk.replace(/(".*?"|'.*?')/g,'<span class="h-string">$1</span>');chunk=chunk.replace(/(&lt;)(\/?\w+)(.*?)(&gt;)/g,(match,lt,tag,content,gt)=>{content=content.replace(/(\s+)(\w+)(=)/g,'$1<span class="h-attr">$2</span>$3');return `${lt}<span class="h-tag">${tag}</span>${content}${gt}`});chunk=chunk.replace(/\b(function|var|let|const|if|else|return|new)\b/g,'<span class="h-keyword">$&</span>');highlightedHtml+=chunk+'\n';currentLine=endLine;const highlightPercent=Math.floor((currentLine/totalLines)*90);progressBar.style.width=`${highlightPercent}%`;progressPercent.textContent=`${highlightPercent}% (Highlighting)`;if(currentLine<totalLines){setTimeout(processChunk,0)}else{progressBar.style.width='95%';progressPercent.textContent='95% (Updating Editor DOM)';highlightedCode.innerHTML=highlightedHtml;updateLineNumbers();updateCursorPosition();syncScroll();setTimeout(()=>{progressBar.style.width='100%';progressPercent.textContent='100% (Ready to Run)';setTimeout(()=>{hideLoading();isProcessingLargeFile=false},200)},0)}};processChunk()}codeEditor.addEventListener('paste',(e)=>{const pastedText=e.clipboardData.getData('text');if(pastedText.length>LARGE_PASTE_THRESHOLD){e.preventDefault();codeEditor.value=pastedText;processCodeInChunks(pastedText)}});function highlightContentSync(code){code=code.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");code=code.replace(/(&lt;!--.*?--&gt;)/gs,'<span class="h-comment">$1</span>');code=code.replace(/(".*?"|'.*?')/g,'<span class="h-string">$1</span>');code=code.replace(/(&lt;)(\/?\w+)(.*?)(&gt;)/g,(match,lt,tag,content,gt)=>{content=content.replace(/(\s+)(\w+)(=)/g,'$1<span class="h-attr">$2</span>$3');return `${lt}<span class="h-tag">${tag}</span>${content}${gt}`});code=code.replace(/\b(function|var|let|const|if|else|return|new)\b/g,'<span class="h-keyword">$&</span>');highlightedCode.innerHTML=code}function handleInput(){if(isProcessingLargeFile)return;const code=codeEditor.value;if(code.length>LARGE_PASTE_THRESHOLD){processCodeInChunks(code);return}updateLineNumbers();highlightContentSync(code);updateCursorPosition();syncScroll();runCode()}function runCode(){if(isProcessingLargeFile)return;const code=codeEditor.value;const iframeDoc=previewFrame.contentDocument||previewFrame.contentWindow.document;iframeDoc.open();iframeDoc.write(code);iframeDoc.close();if(isMobile){}}function loadCode(){const savedCode=localStorage.getItem(LOCAL_STORAGE_KEY);let codeToLoad=savedCode||`<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Hello IDE</title><style>body{background-color:#2e3440;color:#eceff4;padding:20px;font-family:sans-serif}</style></head><body><h1>Welcome to the Single-File IDE!</h1><p>Paste a large file to see the progress bar, then click RUN CODE to see the preview!</p></body></html>`;codeEditor.value=codeToLoad;document.getElementById('save-status').textContent=savedCode?'Auto-Save: Loaded from storage':'Auto-Save: No saved data found';if(codeToLoad.length>LARGE_PASTE_THRESHOLD){processCodeInChunks(codeToLoad)}else{handleInput();runCode();}}function openFile(){document.getElementById('file-input').click()}document.getElementById('file-input').addEventListener('change',(event)=>{const file=event.target.files[0];if(!file)return;showLoading('Loading file...');const reader=new FileReader();reader.onload=(e)=>{codeEditor.value=e.target.result;document.getElementById('save-status').textContent=`File "${file.name}" loaded.`;if(e.target.result.length>LARGE_PASTE_THRESHOLD){processCodeInChunks(e.target.result)}else{handleInput();runCode();hideLoading()}};reader.readAsText(file)});function updateLineNumbers(){const code=codeEditor.value;let fontSize=codeEditor.classList.contains('zoom-in')?18:14;lineNumbers.style.fontSize=`${fontSize}px`;const lineCount=code.split('\n').length;const finalLineCount=Math.max(lineCount,1);lineNumbers.innerHTML=Array(finalLineCount).fill(0).map((_,i)=>(i+1)).join('\n')}function syncScroll(){highlightedCode.scrollTop=codeEditor.scrollTop;highlightedCode.scrollLeft=codeEditor.scrollLeft;lineNumbers.scrollTop=codeEditor.scrollTop}function updateCursorPosition(){const text=codeEditor.value;const cursorPositionIndex=codeEditor.selectionStart;const lines=text.substring(0,cursorPositionIndex).split('\n');const lineNumber=lines.length;const columnNumber=lines[lines.length-1].length+1;cursorPosition.textContent=`Ln: ${lineNumber}, Col: ${columnNumber}`}function autoSave(){localStorage.setItem(LOCAL_STORAGE_KEY,codeEditor.value);saveStatus.textContent='Auto-Save: Saved '+new Date().toLocaleTimeString()}function createNewFile(){if(confirm('Are you sure you want to clear the editor? Any unsaved changes will be lost.')){codeEditor.value='';handleInput();runCode();saveStatus.textContent='New file created. Auto-Save cleared.';localStorage.removeItem(LOCAL_STORAGE_KEY)}}function saveFile(){const code=codeEditor.value;const blob=new Blob([code],{type:'text/html'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='ide_output_'+Date.now()+'.html';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);saveStatus.textContent='Code saved and downloaded as HTML.'}function copyCode(){navigator.clipboard.writeText(codeEditor.value).then(()=>{saveStatus.textContent='Code copied to clipboard!'},(err)=>{saveStatus.textContent='Failed to copy code.';console.error('Could not copy text: ',err)})}function switchTab(tabName){const editorPanel=document.getElementById('editor-panel');const previewPanel=document.getElementById('preview-panel');const codeTab=document.getElementById('code-tab');const previewTab=document.getElementById('preview-tab');isMobile=window.innerWidth<768;if(!isMobile)return;if(tabName==='code'){editorPanel.classList.remove('inactive-panel');previewPanel.classList.add('inactive-panel');codeTab.classList.replace('bg-gray-700','bg-blue-600');previewTab.classList.replace('bg-blue-600','bg-gray-700')}else if(tabName==='preview'){editorPanel.classList.add('inactive-panel');previewPanel.classList.remove('inactive-panel');codeTab.classList.replace('bg-blue-600','bg-gray-700');previewTab.classList.replace('bg-gray-700','bg-blue-600')}}function initIDE(){loadCode();autoSaveInterval=setInterval(autoSave,5000);isMobile=window.innerWidth<768;if(isMobile){switchTab('code')}else{document.getElementById('editor-panel').classList.remove('inactive-panel');document.getElementById('preview-panel').classList.remove('inactive-panel');document.getElementById('preview-panel').classList.remove('inactive-panel')}}window.addEventListener('resize',()=>{const wasMobile=isMobile;isMobile=window.innerWidth<768;if(isMobile&&!wasMobile){switchTab('code')}else if(!isMobile&&wasMobile){document.getElementById('editor-panel').classList.remove('inactive-panel');document.getElementById('preview-panel').classList.remove('inactive-panel');document.getElementById('code-tab').classList.replace('bg-blue-600','bg-gray-700');document.getElementById('preview-tab').classList.replace('bg-blue-600','bg-gray-700')}})</script></body></html>
